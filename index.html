<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>Wi-Fi Connect</title>
<link rel="manifest" href="manifest.json">

<!-- iOS PWA -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="apple-touch-icon" href="icons/icon_192.png">

<!-- (–µ—Å–ª–∏ —Å–¥–µ–ª–∞–µ—à—å —Å–ø–ª—ç—à–∏) -->
<link rel="apple-touch-startup-image" href="splash/splash-640x1136.png"
      media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)">
<link rel="apple-touch-startup-image" href="splash/splash-750x1334.png"
      media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)">
<link rel="apple-touch-startup-image" href="splash/splash-1125x2436.png"
      media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3)">

<!-- QR –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>

<style>
:root{
  --accent:#8f6bff;
  --bg:#050015;
  --card-bg:rgba(10,0,40,0.9);
  --text:#f9f4ff;
}

/* —Å–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ –ø–æ —Å–∏—Å—Ç–µ–º–Ω—ã–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º */
@media (prefers-color-scheme: light){
  :root{
    --bg:#f3f4ff;
    --card-bg:rgba(255,255,255,0.9);
    --text:#050015;
  }
}

*{box-sizing:border-box;margin:0;padding:0;}
body{
  font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;
  min-height:100vh;
  background:radial-gradient(circle at top,#23124b,var(--bg));
  color:var(--text);
}
body.neon{
  background:radial-gradient(circle at top,#23124b,#050015);
  color:#f9f4ff;
}

.container{
  max-width:520px;
  margin:32px auto 40px;
  padding:0 14px 20px;
}
.card{
  background:var(--card-bg);
  border-radius:28px;
  padding:20px 18px 22px;
  box-shadow:0 20px 60px rgba(0,0,0,0.7);
}
h1{
  text-align:center;
  margin-bottom:18px;
  font-size:22px;
}
label.title{
  display:block;
  margin-bottom:10px;
  font-size:15px;
}

/* –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã */
.theme-toggle{
  position:fixed;
  top:12px;right:12px;
  width:40px;height:40px;border-radius:50%;
  background:rgba(20,10,60,0.9);
  color:#ffd86b;display:flex;align-items:center;justify-content:center;
  cursor:pointer;font-size:20px;box-shadow:0 0 14px rgba(0,0,0,0.6);
  z-index:10;
}

/* –∫–∞—Ä—É—Å–µ–ª—å —Å–µ—Ç–µ–π */
.network-wrapper{
  overflow:hidden;
  position:relative;
  margin-bottom:20px;
}
.network-track{
  display:flex;
  transition:transform .25s ease-out;
  will-change:transform;
}
.net-card{
  flex:0 0 100%;
  padding:12px 8px 14px;
  border-radius:22px;
  background:rgba(12,4,40,0.95);
  border:2px solid rgba(140,120,255,0.25);
  cursor:pointer;
  text-align:center;
  transition:transform .16s ease, box-shadow .16s ease, border .16s ease, background .16s ease;
  margin-right:12px;
}
body:not(.neon) .net-card{
  background:rgba(255,255,255,0.92);
  border:2px solid rgba(140,120,255,0.3);
}
.net-card img{
  width:70%;
  max-width:150px;
  display:block;
  margin:0 auto 6px;
}
.net-card label{display:block;font-size:18px;}
.net-card small{display:block;font-size:13px;opacity:.82;margin-top:2px;}
.net-card.active{
  border-color:var(--accent);
  box-shadow:0 0 22px rgba(145,120,255,0.9);
  background:radial-gradient(circle at top,rgba(150,120,255,0.25),rgba(18,6,50,0.98));
}
body:not(.neon) .net-card.active{
  background:radial-gradient(circle at top,rgba(150,120,255,0.16),#ffffff);
}

/* —Ç–æ—á–∫–∏-–ø–µ–π–¥–∂–µ—Ä */
.network-dots{
  text-align:center;
  margin-top:6px;
}
.network-dots .dot{
  display:inline-block;
  width:6px;height:6px;
  border-radius:50%;
  margin:0 3px;
  background:rgba(255,255,255,0.3);
}
.network-dots .dot.active{
  background:var(--accent);
}

/* –∫–Ω–æ–ø–∫–∏ */
button{
  width:100%;padding:13px 12px;border-radius:18px;border:none;
  margin-top:12px;font-size:15px;cursor:pointer;
  background:linear-gradient(135deg,#8f6bff,#b073ff);
  color:#fff;box-shadow:0 10px 24px rgba(0,0,0,0.6);
  transition:transform .12s ease, box-shadow .12s ease, filter .12s ease;
}
button:hover{
  transform:translateY(-1px);
  box-shadow:0 16px 30px rgba(0,0,0,0.65);
  filter:brightness(1.03);
}

/* QR */
.qr{
  margin-top:16px;
  text-align:center;
  display:none;
}
.qr canvas{
  border-radius:18px;
  background:#fff;
  padding:6px;
}
.helper{
  margin-top:8px;
  font-size:13px;
  opacity:.84;
  text-align:center;
}

/* –º–æ–±–∏–ª–∫–∏ */
@media (max-width:420px){
  .container{margin-top:22px;}
  .card{border-radius:24px;padding:18px 14px;}
  h1{font-size:20px;}
  .net-card img{width:76%;}
}
</style>
</head>
<body>
<div class="theme-toggle" onclick="toggleTheme()">‚òÄÔ∏è</div>
<div class="container">
  <h1>–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Wi-Fi</h1>
  <div class="card">
    <label class="title">–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Ç—å (—Å–≤–∞–π–ø–∞–π—Ç–µ –≤–ª–µ–≤–æ/–≤–ø—Ä–∞–≤–æ):</label>

    <div class="network-wrapper" id="networkWrapper">
      <div class="network-track" id="networkTrack">
        <div class="net-card" data-net="r2d5">
          <img src="icons/icon_r2d5.svg" alt="r2d5 5 GHz">
          <label>r2d5</label>
          <small>5 GHz ¬∑ –±—ã—Å—Ç—Ä–µ–µ –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö</small>
        </div>
        <div class="net-card" data-net="r2d2">
          <img src="icons/icon_r2d2.svg" alt="r2d2 2.4 GHz">
          <label>r2d2</label>
          <small>2.4 GHz ¬∑ —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ –Ω–∞ —Å—Ç–∞—Ä—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö</small>
        </div>
      </div>
    </div>

    <div class="network-dots">
      <span class="dot active"></span>
      <span class="dot"></span>
    </div>

    <button onclick="autoConnect()">–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (Android)</button>
    <button onclick="showQR()">–ü–æ–∫–∞–∑–∞—Ç—å QR-–∫–æ–¥</button>
    <button onclick="copyPass()">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å</button>

    <div class="qr" id="qrBox">
      <canvas id="qrCanvas" width="200" height="200"></canvas>
    </div>
    <div class="helper" id="helperText"></div>
  </div>
</div>

<script>
const PASSWORD = "Jgthfnbdysq1913";
const networks = ["r2d5","r2d2"];
let selectedIndex = 0;

/* –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞ (–∞–Ω–∏–º–∞—Ü–∏—è –∫–∞—Ä—É—Å–µ–ª–∏ + —Ç–µ–∫—Å—Ç—ã) */
function applySelection(){
  const track = document.getElementById("networkTrack");
  const width = document.getElementById("networkWrapper").clientWidth;
  track.style.transform = "translateX(" + (-selectedIndex * width) + "px)";

  document.querySelectorAll(".net-card").forEach((card, idx)=>{
    card.classList.toggle("active", idx === selectedIndex);
  });
  document.querySelectorAll(".network-dots .dot").forEach((dot, idx)=>{
    dot.classList.toggle("active", idx === selectedIndex);
  });

  document.getElementById("qrBox").style.display = "none";

  const helper = document.getElementById("helperText");
  const net = networks[selectedIndex];
  helper.textContent = net === "r2d5"
    ? "–í—ã–±—Ä–∞–Ω–∞ r2d5 (5 GHz) ‚Äî –æ–±—ã—á–Ω–æ –±—ã—Å—Ç—Ä–µ–µ, –µ—Å–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 5 GHz."
    : "–í—ã–±—Ä–∞–Ω–∞ r2d2 (2.4 GHz) ‚Äî –ª—É—á—à–µ –¥–ª—è —Å—Ç–∞—Ä—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∏ –ø—Ä–∏ –±–æ–ª—å—à–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏.";
}

function selectIndex(idx){
  if(idx < 0 || idx > 1) return;
  selectedIndex = idx;
  applySelection();
}

/* —Å–≤–∞–π–ø –ø–æ –∫–∞—Ä—É—Å–µ–ª–∏ */
(function initSwipe(){
  const wrapper = document.getElementById("networkWrapper");
  let startX = null;
  wrapper.addEventListener("touchstart", e=>{
    startX = e.touches[0].clientX;
  }, {passive:true});
  wrapper.addEventListener("touchend", e=>{
    if(startX === null) return;
    const endX = e.changedTouches[0].clientX;
    const dx = endX - startX;
    if(Math.abs(dx) > 40){
      if(dx < 0) selectIndex(selectedIndex + 1);
      else selectIndex(selectedIndex - 1);
    }
    startX = null;
  });
})();

/* –∞–≤—Ç–æ-–≤—ã–±–æ—Ä –ª—É—á—à–µ–π —Å–µ—Ç–∏ ‚Äî navigator.connection + –≤–æ–∑—Ä–∞—Å—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ */
(function autoSelectBest(){
  const ua = navigator.userAgent || "";
  const isOldAndroid = /Android\s([0-6]\.\d|7\.0)/i.test(ua);
  const isOldiOS = /OS\s(9_|10_|11_)/i.test(ua);
  let prefer5 = !(isOldAndroid || isOldiOS);

  const conn = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
  if(conn){
    if(conn.effectiveType === "wifi" && conn.downlink && conn.downlink > 50 && conn.rtt && conn.rtt < 30){
      prefer5 = true;
    }
    if(conn.downlink && conn.downlink < 10){
      prefer5 = false;
    }
  }
  selectIndex(prefer5 ? 0 : 1);
})();

/* —Ç–µ–º–∞: —Å–∏—Å—Ç–µ–º–Ω–∞—è + —Ä—É—á–Ω–æ–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å */
function toggleTheme(){
  document.body.classList.toggle("neon");
  localStorage.theme = document.body.classList.contains("neon") ? "dark" : "system";
  updateThemeIcon();
}
function updateThemeIcon(){
  document.querySelector(".theme-toggle").textContent =
    document.body.classList.contains("neon") ? "üåô" : "‚òÄÔ∏è";
}
(function initTheme(){
  const stored = localStorage.theme;
  const prefersDark = window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches;
  if(stored === "dark"){
    document.body.classList.add("neon");
  } else if(stored === "system"){
    if(prefersDark) document.body.classList.add("neon");
  } else {
    if(prefersDark) document.body.classList.add("neon");
  }
  updateThemeIcon();
})();

/* QR –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ —á–µ—Ä–µ–∑ QRious */
function showQR(){
  const net = networks[selectedIndex];
  const wifiString = "WIFI:T:WPA;S:" + net + ";P:" + PASSWORD + ";;";
  const canvas = document.getElementById("qrCanvas");
  if(typeof QRious === "function"){
    new QRious({
      element: canvas,
      value: wifiString,
      size: 200,
      level: "H",
      background: "#ffffff",
      foreground: "#000000"
    });
    document.getElementById("qrBox").style.display = "block";
  } else {
    alert("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥—É–ª—å QR. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.");
  }
}

/* Android –∞–≤—Ç–æ-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ */
function autoConnect(){
  const net = networks[selectedIndex];
  const uri = "WIFI:T:WPA;S:" + net + ";P:" + PASSWORD + ";;";
  window.location.href = uri;
}

/* –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è */
function copyPass(){
  navigator.clipboard.writeText(PASSWORD).then(()=>alert("–ü–∞—Ä–æ–ª—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω"));
}

/* –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è / –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø—Ä–∏ —Ä–µ—Å–∞–π–∑–µ */
window.addEventListener("load", ()=>{
  applySelection();
  window.addEventListener("resize", ()=>applySelection());

  if('serviceWorker' in navigator){
    navigator.serviceWorker.register('sw.js').catch(()=>{});
  }
});
</script>
</body>
</html>
